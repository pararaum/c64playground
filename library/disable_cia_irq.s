;;; Routine to disable the CIA timer-interrupts of CIAs.

	.export	_disable_cia_irq

;;; Disable the CIA time-interrupts. Probably it is best to call this routine with disabled interrupts.
;;; INPUT: -
;;; Output: -
;;; Modifies: A
_disable_cia_irq:
        ;; https://www.c64-wiki.com/wiki/Raster_interrupt
	;; https://codebase64.org/doku.php?id=base:introduction_to_raster_irqs
        lda     #$7f
	;; Disable timer interrupts which can be generated by the two
	;  CIA chips the kernal uses such an interrupt to flash the
	;  cursor and scan the keyboard, so we better stop it.
        sta     $dc0d
        sta     $dd0d
	;; By reading this two registers we negate any pending CIA
	;  irqs. If we don't do this, a pending CIA irq might occur after
	;  we finish setting up our irq. This could cause trouble.
        lda     $dc0d
        lda     $dd0d
	rts
